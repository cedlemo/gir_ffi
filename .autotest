# Override autotest default magic to rerun all tests every time a
# change is detected on the file system.
class Autotest
  
  def get_to_green
    begin
      rerun_all_tests
      wait_for_changes unless all_good
    end until all_good
  end
                            
end

Autotest.add_hook :initialize do |at|
  at.add_mapping(/lib\/girffi\/(.*).rb/, true) do |filename, matchdata|
    ["test/#{matchdata[1]}_test.rb"]
  end
  at.add_mapping(/lib\/girffi\/i(.*)info.rb/, true) do |filename, matchdata|
    ["test/builder_test.rb"]
  end
  at.add_mapping(/lib\/girffi\/overrides\/(.*).rb/, true) do |filename, matchdata|
    ["test/#{matchdata[1]}_overrides_test.rb"]
  end
end
